{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class='col-sm-4'>
    {% block title %}
        <title>{{game.title}}</title>
    {% endblock title %}
    <h6 style="color: white">product.name</h6>
    <img class="card-img-top" src="{{ game.image.url }}" style="width:254px; heigth:254px">
</div>
<div class='col-sm-8'>
    <h3 class='text-center'>{{ game.name }}</h3>
    <p>{{ game.description }}</p>
    <hr>

    <p><strong>Ціна: {{ game.price }}</strong></p>
    {% if request.user.is_authenticated %}<a href="#" class="add_to_cart" data-slug="{{ game.slug }}"><button class="btn btn-danger">Додати до корзини</button></a>
    {% else %}<p class="text-center">Замовляти товар можуть лише авторизовані користувачі. <br> Будь-ласка, <a href="{% url 'login' %}">авторизуйтеся</a> або <a href="{% url 'registration' %}">зареєруйтеся</a>.</p>
    {% endif%}
</div>
<script src="{% static 'js/jquery.js' %}"></script>
<script>
    $(document).ready(function()
    {
        $('.add_to_cart').on('click', function(e)
        {
            e.preventDefault()
            game_slug = $(this).attr('data-slug')
            data = {
                game_slug: game_slug
            }
            $.ajax({
                type: "GET",
                url: "{% url 'add_to_cart' %}",
                data: data,
                success: function(data){
                    $("#cart_count").html(data.cart_total)
                }
            })
        })
    })
</script>
{% endblock content %}